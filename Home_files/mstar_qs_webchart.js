var TEXT={};TEXT.Login="Please login.";TEXT.GoButton="Please enter an exchange code like XNAS:MSFT.";TEXT.WSInput="Please enter a name.";TEXT.WSSavedSuccessfully="Workspace saved.";TEXT.WSName="The same name already exists. Please enter a different name.";TEXT.OpenShareRenameWS='The shared workspace name ({0}) already exists.<br/>Morningstar Markets will open this shared workspace with "Untitled".';TEXT.ShareError="Sorry, there was an error in sharing your widget/workspace. <br/>Please try again later.";TEXT.ShareSaveConfirm="Save changes before sharing?";TEXT.WSRenameSuccess="Renamed successfully.";TEXT.WSRename="Sorry, there was an error when you rename this workspace.<br/>Please try again later.";TEXT.WSSaveError="Sorry, there was an error in saving your workspace. <br/>Please try again later.";TEXT.WSSaveTimeout="A connection error has occurred.<br/> Re-login is recommended by clicking OK.";TEXT.WSSaveDefault='This is a read-only template. <br/>Please use "Save Workspace As" to save this Workspace.';TEXT.WSCaptureAlert="Only one Workspace can be captured at a time.";TEXT.WSDelConfirm="Are you sure you want to delete?";TEXT.NullSubject="Send message without a subject?";TEXT.WSDelError="Sorry, there was an error in deleting your workspace. <br/>Please try again later.";TEXT.WSDelDefault="Default Workspaces cannot be deleted.";TEXT.WSCloseError="At least one Workspaces should be opened.";TEXT.WatchListSavedSuccessfully="Saved successfully.";TEXT.WatchListLimit="There is a limit of {0} symbols for Morningstar Markets.<br /><br /> To add more symbols, please remove one or more symbols.";TEXT.WatchListTempLimit="There is a limit of showing {0} constituents for index.";TEXT.WatchListSplitLimit="There is a limit of {0} symbols for Morningstar Markets.<br /> Only the first {0} symbols have been saved.";TEXT.WatchListSaveError="Sorry, there was an error in saving your portfolio/Watchlist. <br/>Please try again later.";TEXT.WatchListRenameError="Sorry, there was an error when you rename this portfolio/Watchlist.<br/>Please try again later.";TEXT.WatchListSaveError2="Save Portfolio/Watchlist Error.<br />Reached max holding.";TEXT.WatchListInput="Please enter a name.";TEXT.WatchListTitle="The title is too long.";TEXT.WatchListTitle2="The same name already exists. Please enter a different name.";TEXT.WatchListCreateError="Sorry, there was an error in creating your portfolio/Watchlist. <br/>Please try again later.";TEXT.WatchListCreateSuccess="Created successfully.";TEXT.WatchListSaveasSuccess="Save as successfully.";TEXT.WatchListRenameSuccess="Renamed successfully.";TEXT.WatchListDeleteSuccess="Deleted successfully.";TEXT.WatchListNewError="Sorry, there was an error in creating your portfolio/Watchlist. <br/>Please try again later.";TEXT.WatchListDelConfirm='Are you sure you want to delete "[TITLE]"?';TEXT.WatchListCVEditDef="This is a read-only view. <br/>Please enter a new name to save this view.";TEXT.WatchListCVInput="Please enter a name.";TEXT.WatchListCVSelect="Please select a column.";TEXT.WatchListCVTitle="Custom View with the same name already exists. Please enter a different name.";TEXT.WatchListCVSuccess="Custom View saved.";TEXT.WatchListCVFailed="Custom View is unavailable. Please try again later.";TEXT.WatchListCVDelete="Custom View deleted.";TEXT.WatchListCVDelConfirm="Are you sure you want to delete?";TEXT.ShareWatchList="The custom view name of shared watchlist is already exists, please enter a different name.";TEXT.ShareNews="The view name of shared news is already exists, please enter a different name.";TEXT.ShareFailed="Share failed, Please try it again later.";TEXT.MessageSendSuccess="Message is sent to the recipient successfully.";TEXT.NewsSameName="The same View Name already exists. Please enter a different name.";TEXT.WatchListEDInput1="Please enter valid number and date.";TEXT.WatchListEDInput2="Please enter a valid number.";TEXT.WatchListEDInput3="Please enter a valid date.";TEXT.WatchListEDInput4="All items should be filled.";TEXT.WatchListEDInput5="Please enter a number greater than zero.";TEXT.WatchListEDInputName="Please enter a name.";TEXT.WatchListSaveDefWL='This is a read-only Watchlist. <br/>Please use "Save As" to save this Watchlist.';TEXT.WatchListDeleteDefWL="Default Watchlists can not be deleted.";TEXT.WatchListCanNotDelete="This is a read-only Watchlist, can not be deleted.";TEXT.WatchListDeleteError="An error had happened when you deleted this watchlist.<br/>Please try again later.";TEXT.WatchListEditDefWL="Default Watchlists cannot be edited.";TEXT.NoConstituents="No constituents data is available.";TEXT.WLImportInputFile="Please choose a file.";TEXT.WLImportCopyPrompt="Please copy and paste symbol lists from Excel to the textarea!";TEXT.WLImportEmptyFile="Empty excel!";TEXT.WLImportColumnLimit="Column limit for importing is 10! ";TEXT.WLImportDuplicate="Can't select duplicate option!";TEXT.WLImportNoTicker="Have no ticker!";TEXT.WLImportNoTickerInput="No ticker inputted!";TEXT.WLImportTickerInvalid="No ticker valid!";TEXT.WLImportTickerOverMax="Watchlist has reached the tickers number limit({0}), Please reduce your tickers number.";TEXT.WLImportNoSymbolColumn="Must have Symbol column! ";TEXT.beta="This is a new feature that might have a few kinks to work out.";TEXT.TickerInValid='Can\'t find "{0}". Do you want to remove?<br/><br/><p style="padding-bottom:1px;"><span style="display:inline-block;width:73px;padding:2px;">Click "Yes"</span><span>- Remove</span></p><p style="padding-top:1px;"><span style="display:inline-block;width:73px;padding:2px;">Click "No"</span><span>- Keep in your Watchlist and don\'t remind again.</span></p>';TEXT.saveWorkspaceFirst="Please save workspace firstly. And then detach this window.";TEXT.QtIDRTicker="Please select a ticker.";TEXT.QtIDRNotSupportIndex="No data available";TEXT.ResearchNoData="We don't have data on this ticker currently.";TEXT.ForexSaveError="Sorry, there was an error in saving your Forex list. <br/>Please try again later.";TEXT.ForexSavedSuccessfully="Forex list saved.";TEXT.ForexInput="Please enter a name.";TEXT.ForexInput2="Please enter a name.";TEXT.ForexTitle="The title is too long.";TEXT.ForexDelConfirm="Are you sure you want to delete?";TEXT.ForexExistPair="<p>The same pair already exists.</p><p>Please choose a different pair.</p>";TEXT.ForexSameName="The same name already exists. Please enter a different name.";TEXT.AlertSavedSucceddfully="Alert saved.";TEXT.AlertSavedError="Sorry, there was an error in saving your Alert. <br/>Please try again later.";TEXT.LicenseDeclineConfirm="Are you sure you want to decline? For assistance please contact product support at 312-244-7230.";TEXT.MDTickerOver100="Tickers you selected are more than 100";TEXT.TickerValidationNotFound='We could not find the security["{0}"] you are looking for. Please try again.';TEXT.TickerValidationNoPermission='You are not entitled to access ["{0}"]';TEXT.NoSecuritityTypePermission='We are sorry, but you are not entitled to view the data for "{0}".';var QSTIPs=[];QSTIPs[0]='<h3>Support Window</h3><p>To access training videos and other support materials, such as the release notes, click on the large gear menu and select Support.</p><img src="help/help_support.gif" width="425" height="205" />';QSTIPs[1]='<h3>Create New Workspace</h3><p><img src="help/help_iconadd.gif" width="34" height="28" />Click on the "+" icon on the global bar to access the Workspace Management System. Click "Create New Workspace" to create a new workspace, the new untitled workspace will not automatically save. Click "Save" icon to open "save as dialog", name it and click OK to save successfully.</p>';QSTIPs[2]='<h3>Adding Windows to a Workspace</h3><p>Click on the <img src="help/help_addwin.gif" width="107" height="22" /> tab located in the upper left corner of your screen. In the Add Windows panel either click or drag-and-drop window to add it to the workspace.</p>';QSTIPs[3]='<h3>Settings</h3><p>Click on the large gear icon <img src="help/help_iconsetting.gif" width="26" height="26" /> to access the application settings. Window settings can be found by clicking on the "Edit" option for each component within a workspace.</p>';QSTIPs[4]="<h3>Basic Interactions</h3><ul><li>+ Drag-and-drop securities from the watchlist onto to the chart or news window.</li><li>+ Double-click a security on your watchlist to propagate the security to all open windows.</li><li>+ Right-click in a window to reveal actions or settings for the active window.</li><li>+ Hover over the workspace name tab to access workspace settings.</li></ul>";QSTIPs[5]='<h3>Using Search Capability</h3><p>In the Search box, type a symbol or a company name. Select a security.</p><img src="help/help_srh.gif" width="252" height="103" /><p>From the dropdown menu, select the window you would like to add for this security. Select "All Windows" option if you would like all windows in your workspace to be updated for this security. Click Go.</p>';QSTIPs[6]="<h3>Full Screen</h3><p>Hit F11 key to maximize your viewing area.</p>";TEXT.ChartCTickersOverstep="There is a limit of 7 symbols to compare.<br /><br /> To add more symbols, please remove one or more symbols.";TEXT.ChartCTickersNoEntitled="You are not entitled to access this security.";TEXT.Alert={};TEXT.Alert["1"]="One of the required information alertType is missing.";TEXT.Alert["2"]="One of the required information productCode is missing.";TEXT.Alert["3"]="One of the required information symbol is missing.";TEXT.Alert["4"]="One of the required information alertOutput is missing.";TEXT.Alert["5"]="One of the required information email address is missing.";TEXT.Alert["6"]="One of the required information userExpenseRatio is missing.";TEXT.Alert["7"]="One of the required information userStandardDeviation is missing.";TEXT.Alert["8"]="One of the required information userStewardshipGrade is missing.";TEXT.Alert["9"]="One of the required information userReturnValue is missing.";TEXT.Alert["10"]="One of the required information userRankValue is missing.";TEXT.Alert["11"]="One of the required information userAlpha is missing.";TEXT.Alert["12"]="One of the required information userBeta is missing.";TEXT.Alert["13"]="One of the required information userSharpeRatio is missing.";TEXT.Alert["14"]="One of the required information userSortinoRatio is missing.";TEXT.Alert["15"]="One of the required information userCaptureRatio is missing.";TEXT.Alert["16"]="One of the required information userStarRating is missing.";TEXT.Alert["17"]="One of the required information userQuartile is missing.";TEXT.Alert["18"]="One of the required information userStandardDeviation is missing.";TEXT.Alert["19"]="One of the required information user target percentage is missing.";TEXT.Alert["20"]="One of the required information user target price is missing.";TEXT.Alert["21"]="One of the required information user target Price or user Target Percentage is missing.";TEXT.Alert["22"]="One of the required information user Volume is missing.";TEXT.Alert["23"]="One of the required information user 52weekHigh is missing.";TEXT.Alert["24"]="One of the required information user 52weekLow is missing.";TEXT.Alert["25"]="One of the required information user 52weekHigh percentage is missing.";TEXT.Alert["26"]="One of the required information user 52weekLow percentage is missing.";TEXT.Alert["27"]="One of the required information target change is missing.";TEXT.Alert["28"]="One of the required information user Size is missing.";TEXT.Alert["29"]="Please enter a valid email address. For example, myname@example.com.";TEXT.Alert["30"]="alertOutput only support EMAIL or NOTIFICATION or BOTH or NONE.";TEXT.Alert["31"]="the email outputType only support TEXT or HTML.";TEXT.Alert["32"]="One of the required information alertType is invalid.";TEXT.Alert["33"]="One of the required information productCode is invalid.";TEXT.Alert["34"]="One of the required information userQuartile is invalid,userQuartile are 1,2,3.";TEXT.Alert["35"]="One of the required information userStarRating is invalid,userStarRating are 2,3,4,5.";TEXT.Alert["36"]="One of the required information userStyleConsistency is invalid,userStyleConsistency are Medium or High.";TEXT.Alert["37"]="One of the required information filingForm is invalid.";TEXT.Alert["38"]="One of the required information filingType is invalid.";TEXT.Alert["39"]="customerId is invalid.";TEXT.Alert["40"]="customerFirstName is invalid.";TEXT.Alert["41"]="customerLastName is invalid.";TEXT.Alert["42"]="culture is invalid.";TEXT.Alert["43"]="currency is invalid.";TEXT.Alert["44"]="The value you entered is invalid.";TEXT.Alert["45"]="The value you entered is invalid.";TEXT.Alert["46"]="The value you entered is invalid.";TEXT.Alert["47"]="The value you entered is invalid.";TEXT.Alert["48"]="The value you entered is invalid.";TEXT.Alert["49"]="ServiceCode is invalid.";TEXT.Alert["50"]="The symbol you entered is not valid. Please enter another symbol.";TEXT.Alert["51"]="IdType is invalid.";TEXT.Alert["52"]="Alert already exists.";TEXT.Alert["53"]="The subscription is suspended.";TEXT.Alert["54"]="The subscription is active.";TEXT.Alert["55"]="Your subscription cannot be found.";TEXT.Alert["56"]="One of the required information customerId is missing.";TEXT.Alert["57"]="One of the required information ServiceCode is missing.";TEXT.Alert["58"]="Invalid newsType.";TEXT.Alert["59"]="One of the required information filing type is missing.";TEXT.Alert["60"]="One of the required information filingForm is missing.";TEXT.Alert["61"]="One of the required information subscriptionId is missing.";TEXT.Alert["62"]="Please enter a valid email address. For example, myname@example.com.";TEXT.Alert["63"]="collection is invalid.";TEXT.Alert["64"]="can not find alertInfo.";TEXT.Alert["65"]="Invalid subscriptionId.";TEXT.Alert["66"]="Invalid start value.";TEXT.Alert["67"]="Invalid maxCount value.";TEXT.Alert["68"]="No value for the parameters.";TEXT.Alert["69"]="Invalid Date, Date should be 'yyyy-MM-dd hh:mm:ss'.";TEXT.Alert["70"]="Invalid SortType value.";TEXT.Alert["71"]="subscription Id or CustomerId.";TEXT.Alert.emailIsEmpty="Please enter a valid email address.";TEXT.Alert.saveEmailFirst="Please save the email first.";TEXT.Alert.eamilSaveSuccessful="Your email address was updated successfully.";TEXT.Alert.eamilSaveFaild="Your email address was updated failed.";TEXT.Alert.requireTicker="Ticker is a required field. Please enter a ticker.";TEXT.Alert.requireValue="Value is a required field. Please enter a value.";TEXT.Alert.invalidValue="The value you entered is invalid. Please enter a numeric value.";if(!Util){var Util={}}Util.Scrollbar=function(d,c,a,b){this.panelObj=d;this.container=d.el;this.target=c;this.html='<a class="rtq-scrollbar-up">UP</a><div class="rtq-scrollbar-bar"></div><a class="rtq-scrollbar-down">DOWN</a>';this.mod;this.bar;this.btnUp;this.btnDown;this.scrollTimer=null;this.scrolling=false;this.dragPos={x:0,y:0};this.len=0;this.scrollLength=0;this.isShow=false;this.parentPadding=0;this.barBorder=2;this.barLen=0;this.cfg={disable:false,type:"y",modBorder:2,aW:12};if(a){$.extend(this.cfg,a)}this.CB={onScroll:function(e){},onScrollEnd:function(e){}};if(b){$.extend(this.CB,b)}this.init()};Util.Scrollbar.prototype={init:function(){var a=this;this.mod=$('<div class="rtq-scrollbar">').html(this.html).addClass((this.cfg.type=="y")?"rtq-scrollbar-y":"rtq-scrollbar-x").bind("click",{self:this},this._clickScroll);this.bar=this.mod.find(".rtq-scrollbar-bar").bind("mousedown",{self:this},this._startDrag).bind("mouseup",{self:this},this._stopDrag);this.btnUp=this.mod.find(".rtq-scrollbar-up").bind("mousedown",{self:this},this._startScrollUp).bind("mouseup",{self:this},this._stopScroll);this.btnDown=this.mod.find(".rtq-scrollbar-down").bind("mousedown",{self:this},this._startScrollDown).bind("mouseup",{self:this},this._stopScroll);this.parentPadding=this.cfg.aW;this.mod.appendTo(this.container);this.scrollTo(0)},reSize:function(a){this._resetBar();this.scrollTo(this._getScrollTop());if(a){if(!this.isShow){this.show();this._setParentPadding(this.parentPadding)}}else{if(this.isShow){this.hide();this._setParentPadding(0)}}},scrollTo:function(a){var b=this.scrollLength-this.len;a=a<0?0:(a>b?b:a);if(a<=b&&a>=0){this._scrollTo(a)}},scrollPercentTo:function(a){this.scrollTo(a*(this.scrollLength-this.len))},show:function(){this.mod.show();this.isShow=true},hide:function(){this.mod.hide();this.isShow=false},_resetBar:function(){if(this.cfg.type=="y"){var a=this.target.height();if(a&&a>=this.cfg.aW*2){this.len=a-this.cfg.modBorder;this.scrollLength=this.target[0].scrollHeight||1;this.mod.css({height:this.len});this.barLen=Math.round((this.len-this.cfg.aW*2)*this.len/this.scrollLength);this.bar.css({height:Math.max(this.barLen-this.barBorder,2)})}}else{var b=this.target.width();if(b&&b>=this.cfg.aW*2){this.len=b-this.cfg.modBorder;this.scrollLength=this.target[0].scrollWidth||1;this.mod.css({width:this.len});this.barLen=Math.round((this.len-this.cfg.aW*2)*this.len/this.scrollLength);this.bar.css({width:Math.max(this.barLen-this.barBorder,2)})}}},_setParentPadding:function(a){if(this.cfg.type=="y"){this.target.css({width:this.container.width()-a})}else{this.target.css({height:this.container.height()-a})}},_scrollTo:function(a){this.CB.onScroll(a);var b=Math.round((a*(this.len-this.cfg.aW*2-this.barLen)/(this.scrollLength-this.len))+this.cfg.aW);if(b<this.cfg.aW){b=this.cfg.aW}else{if((b+this.barLen+this.barBorder)>(this.len-this.cfg.aW)){b=this.len-this.cfg.aW-this.barLen+this.cfg.modBorder}}if(this.cfg.type=="y"){this.target.scrollTop(a);this.bar.css({top:b||0})}else{this.target.scrollLeft(a);this.bar.css({left:b||0})}},_getScrollTop:function(){return(this.cfg.type=="y")?this.target.scrollTop():this.target.scrollLeft()},_clickScroll:function(b){if($(b.target).hasClass("rtq-scrollbar")){var c=b.data.self;c.scrolling=true;var a=(c.cfg.type=="y")?b.clientY-c.bar.offset().top:b.clientX-c.bar.offset().left;if(a>0){c.scrollTo(c._getScrollTop()+100)}else{c.scrollTo(c._getScrollTop()-100)}c.CB.onScrollEnd(c.cfg.type=="y"?c.target.scrollTop():c.target.scrollLeft())}},_startScrollUp:function(a){var b=a.data.self;b.scrolling=true;b._scroll(-10)},_startScrollDown:function(a){var b=a.data.self;b.scrolling=true;b._scroll(10)},_startDrag:function(a){var d=a.data.self;var b=d.bar.position();d.dragPos={x:parseInt(a.clientX-b.left),y:parseInt(a.clientY-b.top)};d.scrolling=true;var c=a.target;$(document).bind("mousemove.Scrollbar",function(e){e.preventDefault();if(d.cfg.type=="y"){d.scrollTo((e.clientY-d.dragPos.y-d.cfg.aW)*d.scrollLength/(d.len-2*d.cfg.aW))}else{d.scrollTo((e.clientX-d.dragPos.x-d.cfg.aW)*d.scrollLength/(d.len-2*d.cfg.aW))}});$(document).bind("mouseup.Scrollbar",function(){d._stopDrag(a)});if(c.setCapture){document.body.unselectable="on";document.body.onselectstart=function(){return false};c.setCapture()}document.body.onselectstart=function(){return false};c.style.userSelect=c.style.MozUserSelect="none"},_stopDrag:function(a){var c=a.data.self;$(document).unbind("mousemove.Scrollbar").unbind("mouseup.Scrollbar");c.CB.onScrollEnd(c.cfg.type=="y"?c.target.scrollTop():c.target.scrollLeft());var b=a.target;if(b.releaseCapture){document.body.unselectable="";document.body.onselectstart=null;b.releaseCapture()}document.body.onselectstart=function(){return true};b.style.userSelect=b.style.MozUserSelect=""},_scroll:function(a){var b=this;if(this.scrolling){this.scrollTimer=setTimeout(function(){b.scrollTo(b._getScrollTop()+a);b._scroll(a)},30)}else{clearTimeout(this.scrollTimer);this.scrollTimer=0}},_stopScroll:function(a){var b=a.data.self;b.scrolling=false;b.CB.onScrollEnd(b.cfg.type=="y"?b.target.scrollTop():b.target.scrollLeft())},clear:function(){this.mod.unbind(),this.bar.unbind(),this.btnUp.unbind(),this.btnDown.unbind();this.bar=this.btnUp=this.btnDown=null;this.mod.remove(),this.mod=null;for(var a in this){if(!a||a=="clear"){continue}this[a]=null;delete this[a]}}};Util.ScrollPanel=function(b,a,c){this.el;this.target=$(b);this.scrollbarX={scrollTo:function(){},reSize:function(){}};this.scrollbarY={scrollTo:function(){},reSize:function(){}};this.cfg={disable:false,arrowSize:14,barWidth:12,showX:true,showY:true,delayRun:true};if(a){$.extend(this.cfg,a)}this.CB={onScroll:function(d,e){},onScrollEnd:function(d,e){}};if(c){$.extend(this.CB,c)}this.scrollLeft=0;this.scrollTop=0;this.init()};Util.ScrollPanel.prototype={init:function(){var a=this;this.el=$('<div class="rtq-scrollpanel">').css({}).mousewheel(function(f,c){if(a.scrollbarY.isShow){f.preventDefault()}if(c>0){a.scrollbarY.scrollTo(a._getScrollTop()-30)}else{a.scrollbarY.scrollTo(a._getScrollTop()+30)}if(a.cfg.showY){a.scrollTop=a.scrollbarY.target.scrollTop();a._onScrollEnd()}});this.target.css({overflow:"hidden"});if(this.cfg.showX){this.scrollbarX=new Util.Scrollbar(this,this.target,{type:"x",aW:this.cfg.arrowSize},{onScroll:function(c){a.scrollLeft=c;a._onScroll()},onScrollEnd:function(c){a.scrollLeft=c;a._onScrollEnd()}});this.scrollLeft=this.scrollbarX.target.scrollLeft()}if(this.cfg.showY){this.scrollbarY=new Util.Scrollbar(this,this.target,{type:"y",aW:this.cfg.arrowSize},{onScroll:function(c){a.scrollTop=c;a._onScroll()},onScrollEnd:function(c){a.scrollTop=c;a._onScrollEnd()}});this.scrollTop=this.scrollbarY.target.scrollTop()}var b=this.target.parent();this.target.appendTo(this.el);this.el.appendTo(b)},_checkNeedShowXY:function(e,a){var f=e||this.target.width();var c=a||this.target.height();if(f<=0&&c<=0){return 0}this.target[0].style.width=(f-this.cfg.arrowSize)>0?f-this.cfg.arrowSize+"px":0+"px";this.target[0].style.height=(c-this.cfg.arrowSize)>0?c-this.cfg.arrowSize+"px":0+"px";var b=this.target[0].scrollWidth;var d=this.target[0].scrollHeight;this.target[0].style.width=f>0?f+this.cfg.arrowSize+"px":f;this.target[0].style.height=c+this.cfg.arrowSize+"px";if(f>=b&&c>=d){return 0}else{if(f<b){if(c-(this.scrollbarX.isShow?0:this.cfg.arrowSize)<d){return 3}else{return 1}}else{if(c-(this.scrollbarY.isShow?0:this.cfg.arrowSize)<d){if(f<b){return 3}else{return 2}}}}},_onScroll:function(){this.CB.onScroll(this.scrollLeft,this.scrollTop)},_onScrollEnd:function(){this.CB.onScrollEnd(this.scrollLeft,this.scrollTop)},_resize:function(c,a){var e=this.el.parent();c=c||e.width();a=a||e.height();var b=this._checkNeedShowXY(c,a);var f=this.cfg.showY&&(b==3||b==2)?this.cfg.barWidth:0;var d=this.cfg.showX&&(b==3||b==1)?this.cfg.barWidth:0;this.el.css({width:c,height:a});this.target.css({width:(c>f)?c-f:0,height:(a>d)?a-d:0});if(!this.cfg.showX){this.target[0].style.width="auto";if(f>=0){this.target[0].style.paddingRight=f+"px"}this.el[0].style.width="auto"}if(!this.cfg.showY){this.target[0].style.height="auto";if(d>=0){this.target[0].style.paddingBottom=d+"px"}this.el[0].style.height="auto"}this.scrollbarX.reSize(this.cfg.showX&&(b==3||b==1));this.scrollbarY.reSize(this.cfg.showY&&(b==3||b==2));if(this.scrollbarY.isShow&&this.scrollbarX.isShow){this.el.addClass("rtq-scrollpanel-both")}else{this.el.removeClass("rtq-scrollpanel-both")}},reSize:function(c,a,d){var b=this;if(this.cfg.delayRun==true){Util.DelayRun("resize",function(){b._resize(c,a);if(d){d()}},10,this)}else{b._resize(c,a);if(d){d()}}},reSizeRealTime:function(b,a){this._resize(b,a)},_getScrollTop:function(){return this.target.scrollTop()},setDelayRun:function(a){this.cfg.delayRun=a},clear:function(){if(this.scrollbarX!=null&&typeof(this.scrollbarX.clear)=="function"){this.scrollbarX.clear()}if(this.scrollbarY!=null&&typeof(this.scrollbarY.clear)=="function"){this.scrollbarY.clear()}this.el.unbind();this.el.remove()}};var simpleAutoCompleteBox=function(e,b,a,d,c){this.id=e;this.input=null;this.type=a;this.data=b;this.matchData=null;this.domReady=false;this.boxIsAvailable=false;this.index=-1;this.dom={};this.callback=d;this.cfg=$.extend({width:120},true,c);this.textChangeTimeout=null;this.HTML="<div class='simpleAutoCompleteBox'><div class='simpleAutoCompleteBoxWrap'><ul></ul></div></div>"};simpleAutoCompleteBox.prototype={init:function(){this._generateDom();this.input=$("#"+this.id);var a=this;this.input.bind("keyup.simpleAutoCompleteBox",function(b){if(b.keyCode==40||b.keyCode==37||b.keyCode==38||b.keyCode==39||b.keyCode==13){return}if(a.textChangeTimeout!=null){clearTimeout(a.textChangeTimeout)}a.textChangeTimeout=setTimeout(function(){if(!a.boxIsAvailable){a.dom.dom.css({top:a.input.offset().top+a.input.outerHeight()+"px",left:a.input.offset().left})}if(a.input.val()==""){a.hide();return}a.matchData=a._matchString(a.input.val());a._bindUI();a.textChangeTimeout=null},100)});this.dom.dom.bind("click.simpleAutoCompleteBox",function(c){var d=$(c.target).closest("li");var b=d.attr("index");if(a.callback!=null&&typeof(a.callback.onclick)=="function"){a.callback.onclick(b)}a.hide()});this.dom.ul.bind("mouseover.simpleAutoCompleteBox",function(b){var c=$(b.target).closest("li");c.parent().find("li").removeClass("mover");c.addClass("mover")});$(document.body).bind("click.simpleAutoCompleteBox",function(){a.hide()})},setData:function(a){this.data=a},setType:function(a){this.type=a},show:function(){this.dom.dom.show()},hide:function(){this.dom.dom.hide()},_matchString:function(f){var g=new RegExp(f,"i");var a=null;var e={};if(this.type=="[]"){for(var b=0;b<this.data.length;b++){a=this.data[b].match(g);if(a!=null){e[b]=this.data[b].replace(g,"<span class='highlight'>"+a[0]+"</span>")}}}if(this.type.indexOf("key{")!=-1){var c=this.type.replace("key{","").replace("}","");for(var d in this.data){a=this.data[d][c].match(g);if(a!=null){e[d]=this.data[d][c].replace(g,"<span class='highlight'>"+a[0]+"</span>")}}}return e},_bindUI:function(){var b="";for(var a in this.matchData){if(typeof(this.matchData[a])!="undefined"){b+="<li index="+a+">"+this.matchData[a]+"</li>"}}this.dom.ul.html("");this.dom.ul.append(b);if(b!=""){this.show()}else{this.hide()}},_generateDom:function(){this.dom.dom=$(this.HTML).appendTo(document.body);this.dom.dom.css({width:this.cfg.width});this.dom.wrap=this.dom.dom.find(".simpleAutoCompleteBoxWrap");this.dom.ul=this.dom.wrap.find("ul");if(typeof(document.body)!="undefined"&&document.body!=null){this.domReady=true}this.hide()}};if(typeof QS_autoCompleteBox_implement!="undefined"){QS_autoCompleteBox_implement.prototype.setSecType=function(a){this.cfg.urlCfg.secType=a}}var chartWebPage=function(j,k,i,g,c,b,h,d,a,e,f){this.secTypeBtn=null;this.secTypeOption=null;this._elements={};this.uiComponents={};this.chartName=b;this.chartId=c;this.culture="en-US";this.region="USA";this.type=j;this.autoConfig={showSecTypeOption:false};this.onTickerChange=d;this.isTabConOpen=false;this.initCompareTickers=e||[];this.hasTickerValidation=a;this.onChartHeightChange=null;this.globalProfileUrl="../globalProfile.jsp";this.relatedSecUrl=window.location.protocol+"//financials.morningstar.com/competitors/top5competitors.action?out=1";this.autoSave=false;this.UIcfg={pCtrl1:null,pCtrl2:null,Chart:{showPChart:true,showVChart:true,showLegend:true,showTimeSlider:true},vCtrl:null,autoHeight:true,RightMenu:false,showReset:true,maxRange:10,rangeArray:[],frequecyType:0,fixHeight:false,minW:300,minH:160,QueryStringIDServic:1};this.defaultConfig={width:800,height:400,mTicker:"XNYS:IBM",bTerminalUrlPath:false,showLastLabel:false};if(k.mTicker!=null){this.defaultConfig.mTicker=k.mTicker}if(k.width!=null){this.defaultConfig.width=k.width}if(k.height!=null){this.defaultConfig.height=k.height}this.statusConfig=$.extend(true,{},this.defaultConfig,k);if(f){this.UIcfg=$.extend(true,{},this.UIcfg,f)}if(this.UIcfg.fixHeight){this.outerChartHeight=this.statusConfig.outerChartHeight||this.statusConfig.height}this.autoSave=this.UIcfg.autoSave;if(h){if(typeof h=="boolean"){this.autoConfig.showAuto=h}else{this.autoConfig=$.extend(true,{},this.autoConfig,h)}}this.el=g;this.el.addClass("qs-urlchart-container");this.toolModules={compare:{txt:QS_Lang.Chart.compare,val:"compare",items:{relatedSec:true,autoBox:true,select:true}},indicators:{txt:QS_Lang.Chart.indicators,val:"indicators",items:{events:true,indicator:true,fundamental:true}},fundamental:{txt:QS_Lang.Chart.fundamental,val:"fundamental"},drawing:{txt:QS_Lang.Chart.drawing,val:"drawing"},display:{txt:QS_Lang.Chart.display,val:"display",items:{chartCursor:true,chartType:true,yAxisType:true,scaleType:true,selectionMode:true}},range:{val:"range",items:{dateInputs:true,frequency:true,zoom:true}},foot:{val:"foot",items:{share:true,"export":true}}};if(this.type==8||this.type==20){delete this.toolModules.fundamental}if(this.type==20){if(this.toolModules.indicators){this.toolModules.indicators["items"]["events"]=false}if(this.toolModules.compare){this.toolModules.compare["items"]["relatedSec"]=false}if(this.toolModules.foot){this.toolModules.foot["items"]["export"]=false}}this._initUiModules(i);this._init()};chartWebPage.prototype={_initUiModules:function(e){if(typeof(e)=="string"&&e!=""){var a=e.split(","),d,c;for(var b=0;b<a.length;b++){d=a[b].split("|");if(!this.toolModules[d[0]]){continue}if(d[1]!=null){c=d[1].split("-");for(var f=0;f<c.length;f++){if(!this.toolModules[d[0]]["items"]||!this.toolModules[d[0]]["items"][c[f]]){continue}delete this.toolModules[d[0]]["items"][c[f]]}}else{delete this.toolModules[d[0]]}}}},_init:function(){var a=this;this.el.html("");this._createChartComponent();if(this.UIcfg.fixHeight){this.UIcfg.MouseWheel=false}this.chartComponent.initUIConfig(this.UIcfg);this._createUI();this.chartComponent.afterCreateUI=function(){if(a._elements.frquency!=null){a.chartComponent.uiComponents.ddlFrequency=new Util.DropDownList(a._elements.frquency[0],function(c,b){a.chartComponent.frequencySelected(c,b);if(a.autoSave){a._autoSave()}},a.chartComponent.frequencyListData,{triggerByClick:false,width:76,disable:false,actionAtInit:false});a.chartComponent.UIConfig.pCtrl1={showFrequency:true}}};this.chartComponent.afterAcceptTickers=function(d){a._addIIVOption();var c=d.mainTicker;a.type=c.mType=="Options"?2:c.mType=="FO"?8:c.mType=="FX"?20:1;if(c){a.statusConfig.mTicker=a.defaultConfig.mTicker=a.chartComponent.mainTicker}if(c.mType=="FE"){delete a.toolModules.fundamental;if(a._elements.toolTabs!=null){a._elements.toolTabs.find("a[value='fundamental']").parent().hide()}if(a._elements.fundamentalPanel!=null){a._elements.fundamentalPanel.hide()}}else{if(a._elements.toolTabs!=null){a._elements.toolTabs.find("a[value='fundamental']").parent().show()}if(a._elements.fundamentalPanel!=null){a.toolModules.fundamental={txt:QS_Lang.Chart.fundamental,val:"fundamental"}}}if(a.autoConfig.showAuto){if(typeof(GB_qsAutoCompleteBox.setTicker)=="function"){GB_qsAutoCompleteBox.setTicker(a.chartId+"gb_box",{ticker:(a.type==20?"%":"")+c.ticker,clientTicker:c.clientTicker})}}if(a.initCompareTickers&&a.initCompareTickers.length){a.chartComponent.addCompairTickers(a.initCompareTickers.join(","));a.initCompareTickers=[]}if(a.toolModules.compare&&a.toolModules.compare.items.relatedSec){a._getRelatedSec()}if(a.toolModules.compare&&GB_qsAutoCompleteBox.subscriptions[a.chartId+"_autoBox"]&&a.secTypeBtn!=null){var b=a.chartComponent.sType=="Options"?2:1;GB_qsAutoCompleteBox.subscriptions[a.chartId+"_autoBox"].setSecType(b)}if(a.autoSave){a._autoSave()}};this._initAutoComplete();this.chartComponent.afterZoomMenuRebind=function(e){if(a._elements.zoom!=null){var b=a._bindZoomData(e),c=a.statusConfig,d=a.chartComponent.zoomRange;a._elements.zoom.html(b);if(c.zRange!=null){a._elements.zoom.find("a[value='"+d+"']").addClass("on")}}};this.statusConfig.height=this.statusConfig.height-this.extHeight;this.chartComponent.Init(this.chartId,this.chartName+".chartComponent",this.statusConfig);this._bindEvent();$.extend(true,this.statusConfig,this.chartComponent.saveConfig());this._initUiComponentsStatus()},_createChartComponent:function(){var a="";if(this.statusConfig.URLPrefix){a=this.statusConfig.URLPrefix}else{if(!this.statusConfig.bTerminalUrlPath){a="../"}}GB_ChartDataManager.dataUrls.intraday=a+"quote.jsp?";GB_ChartDataManager.dataUrls.historical=a+"getStockHistoricalData.jsp?";GB_ChartDataManager.dataUrls.fundamental=a+"getFundamentalData.jsp?";GB_ChartDataManager.dataUrls.minutelyIntraday=a+"getMinutelyIntradayData.jsp?";GB_ChartDataManager.dataUrls.fundHistorical=a+"getFundChartData.jsp?";GB_ChartDataManager.dataUrls.exportDataToExcel=a+"exportChartDataToExcel.jsp?";GB_ChartDataManager.dataUrls.forex=a+"getForexHistoricalData.jsp?";GB_ChartDataManager.dataUrls.drawings=a+"drawmanager.jsp?";GB_autoCompleteBoxDataManager.dataUrls=a+"acb.jsp";GB_autoCompleteBoxDataManager.noCheckPermission=true;GB_qsAutoCompleteBox.hideAdvacedSearch();if(this.type==1||this.type==2){this.chartComponent=new RTChartComponent(this.statusConfig.mTicker,this.region,this.culture);if(this.UIcfg.frequecyType==1){this.chartComponent.defaultFrequencyMenuCfg.history=false}else{if(this.UIcfg.frequecyType==2){this.chartComponent.defaultFrequencyMenuCfg.intraday=false}}}else{if(this.type==8){this.chartComponent=new QS_FundChartComponent(this.statusConfig.mTicker,this.region,this.culture)}else{if(this.type==20){this.chartComponent=new QS_ForexChartComponent(this.statusConfig.mTicker,this.region,this.culture)}}}this.chartComponent.minW=this.UIcfg.minW;this.chartComponent.minH=this.UIcfg.minH;if(typeof(this.chartComponent.id)=="undefined"){this.chartComponent.id=this.chartId}if(this.hasTickerValidation){this.chartComponent.tValidation=new tickerValidation(1,this.chartName+".chartComponent","tValidation");this.chartComponent.type=1;if(typeof(push.proxy)!="undefined"){push.proxy.register(this.chartComponent)}else{if(typeof(QS.Data)!="undefined"){QS.Data.register(this.chartComponent)}}}this.chartComponent.switchShowLastLabel(this.statusConfig.showLastLabel);if(this.UIcfg&&this.UIcfg.customFrencies&&typeof(this.chartComponent.setDefaultFrequencies)=="function"){this.chartComponent.setDefaultFrequencies(this.UIcfg.customFrencies)}},_createUI:function(){var f="";if(this.autoConfig.showAuto){f='<div class="qs-urlchart-gbbox-con"><input class="qs-ui-ipt" id='+this.chartId+"gb_box />"+(this.autoConfig.showSecTypeOption?'<a class="qs-ui-btn auto-sectype-btn" href="javascript:void(0)">STK</a>':"")+'<a class="qs-ui-btn go" value="gb_auto" href="javascript:void(0)">'+QS_Lang.Chart.go+"</a></div>"}var e='<div class="qs-gd2 qs-urlchart-tab-container"><div class="bd"><div class="qs-main"><div class="qs-c"><div class="qs-uchart-tab"><ul class="tabs"></ul></div></div></div><div class="qs-c">'+f+"</div></div></div>";$(e).appendTo(this.el);e="";var a=0;for(var h in this.toolModules){if(h=="range"||h=="foot"){continue}e+='<li><a href="javascript:void(0);" value="'+this.toolModules[h].val+'">'+this.toolModules[h].txt+"</a></li>";this._elements[this.toolModules[h].val+"Panel"]=$('<div class="qs-urlchart-panel qs-urlchart-'+this.toolModules[h].val+'"></div>').appendTo(this.el);this._createPanelUI(this.toolModules[h].val);a++}if(a==0){this.el.find(".qs-urlchart-tab-container .qs-main").remove();this.el.find(".qs-urlchart-tab-container").hide()}this._elements.toolTabs=this.el.find("ul.tabs").html(e);var g;if(this.toolModules.range){g=$('<div class="qs-urlchart-range"></div>').appendTo(this.el);var b=this.toolModules.range.items;if(b.dateInputs){this.chartComponent._elements.$customDate=$('<div class="qs-urlchart-custom-date-con"></div>').appendTo(g);var i=this;this.chartComponent.uiComponents.customDateB=new RTQ_chartCustomDataBox(this.chartComponent._elements.$customDate,{startDate:this.chartComponent.startDate,endDate:this.chartComponent.endDate,width:80,splitLabel:"-",callback:function(l,m){i.chartComponent.startDate=l,i.chartComponent.endDate=m;i.chartComponent._clearZoomIn();i.chartComponent.changeRange(11)},bindEvent:true})}if(b.frequency){this._elements.frquency=$('<div class="qs-urlchart-freq-con"></div>').appendTo(g)}if(b.zoom){g.append('<div class= "qs-urlchart-zoom-con"></div>');var d=this.chartComponent.zoomListData;e=this._bindZoomData(d);this._elements.zoom=g.find(".qs-urlchart-zoom-con").html(e)}}if(this.UIcfg.fixHeight){$('<div class="qs-urlchart-scroll-panel"><div class="qs-urlchart-out" id="'+this.chartId+'"></div></div>').appendTo(this.el);this._elements.chart=this.el.find("#"+this.chartId);var j=this.el.find(".qs-urlchart-scroll-panel");this.chartScrollPN=new Util.ScrollPanel(j[0],{showX:false},{onScroll:function(l,m){}})}else{this._elements.chart=$('<div class="qs-urlchart-out" id="'+this.chartId+'"></div>').appendTo(this.el)}if(this.toolModules.foot!=null){this._elements.shareChart=$('<div class = "qs-urlchart-share-lst"><span class="qs-urlchart-share-ico"></span></div>').appendTo(this.el);var k=this.toolModules.foot.items;if(k.share){this._elements.shareChart.append('<a href="javascript:void(0);" class="qs-urlchart-share">'+QS_Lang.Chart.sharethischart+"</a>")}if(k["export"]&&typeof(this.chartComponent.exportDataToExcel)=="function"){this._elements.shareChart.append('<span> | </span><a href="javascript:void(0);" class="qs-urlchart-export">'+QS_Lang.Chart.exportdatatoexcel+"</a>")}if(k.share){this._elements.shareChart.append('<form><input type="text" class="qs-urlchart-share-ipt qs-ui-ipt"></form>')}}this.extHeight=this.el.height();if(this.UIcfg.fixHeight){this.fixedChartHeight=this.outerChartHeight-this.extHeight;this.el.find(".qs-urlchart-scroll-panel").height(this.fixedChartHeight);var c=this.fixedChartHeight;if(this.isTabConOpen&&this.panelHeight){c=c-this.panelHeight}if(this.chartScrollPN){this.chartScrollPN.reSize(null,c)}this.statusConfig.width=this.statusConfig.width-14}},_bindZoomData:function(b){str="";for(var a=0;a<b.length;a++){if(b[a].val>=11||b[a].val>this.UIcfg.maxRange){continue}if(this.UIcfg.rangeArray.length&&$.inArray(parseInt(b[a].val),this.UIcfg.rangeArray)<0){continue}str+='<a value="'+b[a].val+'" href="javascript:void(0);" >'+b[a].txt+"</a>"}if(this.UIcfg.showReset){str+='<a class="reset" value="reset" href="javascript:void(0);">'+QS_Lang.Chart.reset+"</a>"}return str},_createPanelUI:function(l){var b=this._elements,s,f=this.toolModules,w=this;if(l=="display"){var t=false,r;var x=$('<div class="qs-gd"><div class="bd"><div class="qs-c"></div></div></div>').appendTo(b.displayPanel).find(".qs-c");s=f[l].items;for(var e in s){if(s[e]){if(e=="chartCursor"){x.append('<div class="qs-urlchart-type-lst qs_urlchart-'+e.toLowerCase()+'"><div class="text"><h4>'+QS_Lang.Chart.chartcursor+'</h4></div><div class="qs-urlchart-cursor-con"></div></div>');var n=this.chartComponent.cursorTypeListData;var a="";for(var d=0;d<n.length;d++){a+='<a class="qs-urlchart-item" href="javascript:void(0);" ckey = "chartCursor" value="'+n[d].val+'">'+n[d].txt+"</a>"}b.chartCursor=x.find(".qs-urlchart-cursor-con").html(a)}else{if(e=="chartType"){x.append('<div class="qs-urlchart-type-lst qs_urlchart-'+e.toLowerCase()+'"><div class="text"><h4>'+QS_Lang.Chart.charttype+'</h4></div><div class="qs-urlchart-type-con"></div></div>');var g=this.chartComponent.chartTypeListData;var a="";for(var d=0;d<g.length;d++){a+='<a class="qs-urlchart-item" href="javascript:void(0);" ckey = "chartType" value="'+g[d].val+'">'+g[d].txt+"</a>"}b.chartType=x.find(".qs-urlchart-type-con").html(a)}else{if(e=="yAxisType"||e=="scaleType"||e=="selectionMode"){if(!t){r=$('<div class="qs-urlchart-type-lst qs_urlchart-'+e.toLowerCase()+'"></div>').appendTo(x);t=true}if(e=="yAxisType"){var a="";a+='<div class="text"><h4>'+QS_Lang.Chart.yaxis+'</h4></div><div class="qs-urlchart-yAxisType-con"></div>';var q=$(a).appendTo(r).eq(1);this.uiComponents.yAxisRatio=new Util.ButtonGroup(q,this.chartComponent.yaxisAlignListData,{onClick:function(i){w.chartComponent.setYaxisAlign(i);if(w.autoSave){w._autoSave()}}},{inverse:false})}else{if(e=="scaleType"){var a="",c=s.yAxisType?"qs-urlchart-top10":"";a+='<div class="text '+c+'"><h4>'+QS_Lang.Chart.verticalscale+'</h4></div><div class="qs-urlchart-scaleType-con"></div>';var m=$(a).appendTo(r).eq(1);this.uiComponents.scaleRatio=new Util.ButtonGroup(m,this.chartComponent.scaleTypeListData,{onClick:function(i){w.chartComponent.switchScaleType(i);if(w.autoSave){w._autoSave()}}},{inverse:false})}else{if(e=="selectionMode"){if(this.chartComponent.UIConfig.ZoomIn){this.chartComponent.selectionModeListData.splice(2,1);this.chartComponent.selectionModeListData[0].checked=true;var a="",c=s.yAxisType?"qs-urlchart-top10":"";a+='<div class="text '+c+'"><h4>'+QS_Lang.Chart.selectionmode+'</h4></div><div class="qs-urlchart-selection-con"></div>';var h=$(a).appendTo(r).eq(1);this.uiComponents.selectionRatio=new Util.ButtonGroup(h,this.chartComponent.selectionModeListData,{onClick:function(i){w.chartComponent.setSelectionMode(i);if(w.autoSave){w._autoSave()}}},{inverse:false});h.append('<a href="javascript:void(0)" class="qs-urlchart-zoomout">'+QS_Lang.Chart.reset+"</a>")}}}}}}}}}}else{if(l=="indicators"){var x=$('<div class="qs-gd"><div class="bd"><div class="qs-c"></div></div></div>').appendTo(b.indicatorsPanel).find(".qs-c");s=f[l].items;for(var e in s){if(s[e]){if(e=="indicator"){x.append('<div class="qs-urlchart-type-lst qs_urlchart-'+e.toLowerCase()+'"><div class="text"><h4>'+QS_Lang.Chart.indicators+'</h4></div><div class="qs-urlchart-indicators-con"></div></div>');var j=this.chartComponent.indicatorUI;var a="";for(var e in j){var k=j[e].title;if(e=="MACD"){k=QS_Lang.Chart.macd_name}a+='<a class="qs-urlchart-item qs-urlchart-indicator-'+e.toLowerCase()+'" href="javascript:void(0);" ckey="indicator" value="'+e+'">'+k+"</a>"}x.find(".qs-urlchart-indicators-con").html(a);b.indicatorInputPanel=$('<div class="qs-urlchart-type-lst"><div class="text"><h4></h4></div><div class="qs-urlchart-indicatorInput-con"></div></div>').appendTo(x);var a='<div class="para-list"></div><div class="action-row"><a  href="javascript:void(0);" class = "qs-ui-btn add" value="draw">'+QS_Lang.Chart.add+"</a>";a+='<a href="javascript:void(0);" class = "qs-ui-btn canel" value="cancel">'+QS_Lang.Chart.cancel+"</a>";a+='<a href="javascript:void(0);" class = "qs-ui-btn remove" value="remove">'+QS_Lang.Chart.remove+"</a></div>";b.indicatorInputPanel.find(".qs-urlchart-indicatorInput-con").html(a);b.indicatorInputPanel.hide()}else{if(e=="events"){x.append('<div class="qs-urlchart-type-lst  qs_urlchart-'+e.toLowerCase()+'"><div class="text"><h4>'+QS_Lang.Chart.events+'</h4></div><div class="qs-urlchart-events-con"></div></div>');var u=this.chartComponent.eventsData,a="";for(var d=0;d<u.length;d++){a+='<a class="qs-urlchart-item" href="javascript:void(0);" ckey="events" value="'+u[d].val+'">'+u[d].txt+"</a>"}b.events=x.find(".qs-urlchart-events-con").html(a)}}}}}else{if(l=="fundamental"){var x=$('<div class="qs-gd"><div class="bd"><div class="qs-c"></div></div></div>').appendTo(b.fundamentalPanel).find(".qs-c");x.append('<div class="qs-urlchart-type-lst qs_urlchart-'+l.toLowerCase()+'""><div class="text"><h4>'+QS_Lang.Chart.fundamental+'</h4></div><div class="qs-urlchart-fundamental-con"></div></div>');var v=this.chartComponent.valuations;var a="";for(var e in v){a+='<a class="qs-urlchart-item" href="javascript:void(0);" ckey="indicator" value="'+e+'">'+v[e].name+"</a>"}x.find(".qs-urlchart-fundamental-con").html(a)}else{if(l=="drawing"){var x=$('<div class="qs-gd"><div class="bd"><div class="qs-c"></div></div></div>').appendTo(b.drawingPanel).find(".qs-c");x.append('<div class="qs-urlchart-type-lst qs_urlchart-'+l.toLowerCase()+'"><div class="text"><h4>'+QS_Lang.Chart.drawing+'</h4></div><div class="qs-urlchart-drawing-con"></div></div>');var p=this.chartComponent.drawingData;var a="";for(var d=0;d<p.length;d++){if(p[d].val=="note"){continue}a+='<a class="qs-urlchart-item" href="javascript:void(0);" ckey="drawing" value="'+p[d].val+'">'+p[d].txt+"</a>"}x.find(".qs-urlchart-drawing-con").html(a)}else{if(l=="compare"){var x=$('<div class="qs-gd"><div class="bd"><div class="qs-c"></div></div></div>').appendTo(b.comparePanel).find(".qs-c");s=f[l].items;for(var e in s){if(s[e]){if(e=="relatedSec"){x.append('<div class="qs-urlchart-type-lst qs_urlchart-'+e.toLowerCase()+'"><div class="text"><h4>'+QS_Lang.Chart.relatedsecurities+'</h4></div><div class="qs-urlchart-relatedSec-con"></div></div>');b.relatedSec=x.find(".qs-urlchart-relatedSec-con")}else{if(e=="autoBox"){var a='<div class="qs-urlchart-type-lst qs-urlchart-auto-lst"><div class="text"><h4>';a+=QS_Lang.Chart.enter+" "+QS_Lang.Chart.tickers+'</h4></div><div class="qs-urlchart-tickers-con">';a+='<input class="qs-ui-ipt" id='+this.chartId+'_autoBox /><a class="qs-ui-btn go" value="auto" href="javascript:void(0)">'+QS_Lang.Chart.add+"</a></div>";a+='<div class="text qs-benchmark qs-urlchart-top10"><h4>'+QS_Lang.Chart.enter+" "+QS_Lang.Chart.benchmarks+"</h4></div>";a+='<div class="qs-urlchart-benchmark-con qs-benchmark"><input class="qs-ui-ipt" id='+this.chartId+'_benchmarkBox /><a class="qs-ui-btn go" href="javascript:void(0)" value="benchmark">'+QS_Lang.Chart.add+"</a></div></div>";x.append(a);b.autoBox=x.find(".qs-urlchart-auto-lst")}else{if(e=="select"){var a='<div class="qs-urlchart-type-lst qs-urlchart-select-lst"><div class="text"><h4>'+QS_Lang.Chart.recentsecurities+"</h4></div>";a+='<ul class="qs-urlchart-select-ticker" ></ul></div>';x.append(a);b.select=x.find("ul.qs-urlchart-select-ticker")}}}}}}}}}}},_bindEvent:function(){var a=this,c=this._elements,b=this.statusConfig;this.el.find(".qs-uchart-tab .tabs").unbind("click").bind("click",function(f){var d=$(f.target);var g=d.attr("value");if(d.hasClass("tabon")){d.removeClass("tabon");$(".qs-urlchart-"+g).hide();if(a.isTabConOpen){a.isTabConOpen=false;a._callResizeIFrame({height:a.el.height()})}}else{$(".qs-uchart-tab .tabs .tabon").removeClass("tabon");d.addClass("tabon");$(".qs-urlchart-panel").hide();$(".qs-urlchart-"+g).show();if(!a.isTabConOpen){a.isTabConOpen=true;a.panelHeight=$(".qs-urlchart-"+g).height();a._callResizeIFrame({height:a.el.height()})}}});if(c.zoom!=null){c.zoom.unbind("click").bind("click.webpage",function(d){var g=$(d.target);var h=g.attr("value");if(h=="reset"){GB_ChartDataManager.removeAllDrawings();GB_ChartDataManager.quoteDataMap={};GB_ChartDataManager.registeredSymbols={};var f=a.el.find(".rtc-price-chart").height()+30;if(a.chartComponent.showVolume){f+=80}a.isTabConOpen=false;a.defaultConfig.height=f+a.extHeight;a._elements={};a.statusConfig=$.extend(true,{URLPrefix:a.statusConfig.URLPrefix},a.defaultConfig);a._init();a._callResizeIFrame({height:a.el.height()})}else{if(b.zoomRange!=h){b.zoomRange=h;a.chartComponent.changeRange(h);a._changeRangeUI(h)}}})}if(c.comparePanel!=null){c.comparePanel.find(".qs-urlchart-auto-lst .go").bind("click",function(f){var g=$(f.target).attr("value"),d="";if(g=="auto"){GB_qsAutoCompleteBox.triggerACB(a.chartId+"_autoBox")}else{if(g=="benchmark"){d=c.comparePanel.find("#"+a.chartId+"_benchmarkBox").val();a.chartComponent.addCompairTickers(d)}}})}if(c.displayPanel!=null){c.displayPanel.find(".qs-urlchart-item").unbind("click").bind("click",function(f){var g=$(this);var d=g.attr("ckey"),h=g.attr("value");if(d=="chartCursor"){a.chartComponent.setCursorType(h)}else{if(d=="chartType"){a.chartComponent.setChartType(h)}}b[d]=h;g.parent().find("a").removeClass("qs-urlchart-item-on");g.addClass("qs-urlchart-item-on");if(a.autoSave){a._autoSave()}});c.displayPanel.find(".qs-urlchart-zoomout").unbind("click").bind("click",function(d){a.chartComponent.resetZoom()})}if(c.indicatorsPanel!=null){c.indicatorsPanel.find(".qs-urlchart-item").unbind("click").bind("click",function(h){var i=$(this);var f=i.attr("ckey"),j=i.attr("value");if(f=="events"){if(i.hasClass("qs-urlchart-item-on")){a.chartComponent.switchEvents(j,false);i.removeClass("qs-urlchart-item-on")}else{a.chartComponent.switchEvents(j,true);i.addClass("qs-urlchart-item-on")}if(a.autoSave){a._autoSave()}}else{if(f=="indicator"){var g=a.chartComponent.indicatorUI;if(g[j]&&g[j].parameter&&g[j].parameter.length){c.indicatorsPanel.find("a.qs-urlchart-item").removeClass("qs-urlchart-item-clicked");i.addClass("qs-urlchart-item-clicked");a._showIndicatorParaPanel(j)}else{if(i.hasClass("qs-urlchart-item-on")){a.chartComponent.removeIndicators(j);i.removeClass("qs-urlchart-item-on")}else{a.chartComponent.addIndicators(j);i.addClass("qs-urlchart-item-on");if(j=="Volume"){c.indicatorsPanel.find("a[value='VPlus']").removeClass("qs-urlchart-item-on")}else{if(j=="VPlus"){c.indicatorsPanel.find("a[value='Volume']").removeClass("qs-urlchart-item-on")}}}}}}})}if(c.fundamentalPanel!=null){c.fundamentalPanel.find(".qs-urlchart-item").unbind("click").bind("click",function(d){var f=$(this);var g=f.attr("value");if(f.hasClass("qs-urlchart-item-on")){f.removeClass("qs-urlchart-item-on");a.chartComponent.removeValuations(g)}else{f.addClass("qs-urlchart-item-on");a.chartComponent.addValuations(g)}})}if(c.drawingPanel!=null){c.drawingPanel.find(".qs-urlchart-item").unbind("click").bind("click",function(d){var f=$(this);var g=f.attr("value");if(f.hasClass("qs-urlchart-item-on")){a.chartComponent.cancelDrawing(g);f.removeClass("qs-urlchart-item-on")}else{a.chartComponent.beginDrawing(g);c.drawingPanel.find(".qs-urlchart-item-on").removeClass("qs-urlchart-item-on");f.addClass("qs-urlchart-item-on")}})}this.chartComponent.afterDrawEnd=function(d){if(c.drawingPanel!=null){c.drawingPanel.find("[value='"+d+"']").removeClass("qs-urlchart-item-on")}};if(c.indicatorInputPanel!=null){c.indicatorInputPanel.find(".action-row a").unbind("click").bind("click",function(f){var g=$(f.target).attr("value");var j=c.indicatorInputPanel.attr("value");if(g=="draw"){var h=c.indicatorInputPanel.find(".para-list input"),k=[];k[0]=j;for(var d=0;d<h.length;d++){k.push(h[d].value)}a.chartComponent.addIndicators.apply(a.chartComponent,k);c.indicatorsPanel.find("a[value='"+j+"']").removeClass("qs-urlchart-item-clicked")}else{if(g=="remove"){if(j!=null){a.chartComponent.removeIndicators(j);c.indicatorInputPanel.hide()}c.indicatorsPanel.find("a[value='"+j+"']").removeClass("qs-urlchart-item-clicked")}else{if(g=="cancel"){c.indicatorsPanel.find("a[value='"+j+"']").removeClass("qs-urlchart-item-clicked");j=null}}}c.indicatorInputPanel.hide()})}if(c.select!=null){c.select.unbind("click").bind("click",function(d){var f=$(d.target);if(f.hasClass("close")){var g=f.attr("value");f.parent().remove();a.chartComponent.removeCompairTicker(g)}})}if(c.shareChart!=null){c.shareChart.find("a").unbind("click").bind("click",function(f){var g=$(f.target);if(g.hasClass("qs-urlchart-share")){var h=c.shareChart.find("span.qs-urlchart-share-ico");var i=c.shareChart.find(".qs-urlchart-share-ipt");if(h.hasClass("qs-urlchart-share-ico-on")){h.removeClass("qs-urlchart-share-ico-on");i.hide()}else{h.addClass("qs-urlchart-share-ico-on");var k=a._getChartProfile();var j=$.toJSON(k);var d=window.location.href+"&statePara="+encodeURIComponent(j);i.val(d).show()}}else{if(g.hasClass("qs-urlchart-export")){a.chartComponent.exportDataToExcel()}}})}this.chartComponent.afterRemoveVolumeChart=function(){c.indicatorsPanel.find("a[value='Volume']").removeClass("qs-urlchart-item-on");c.indicatorsPanel.find("a[value='VPlus']").removeClass("qs-urlchart-item-on");c.indicatorsPanel.find("a[value='SMVV']").removeClass("qs-urlchart-item-on");if(a.autoSave){a._autoSave()}};this.chartComponent.afterAddIndicators=function(d){if(c.indicatorsPanel){c.indicatorsPanel.find("a[value='"+d.indicatorName+"']").addClass("qs-urlchart-item-on")}if(a.chartComponent.indicatorsData[d.indicatorName].type==1){a._callResizeIFrame({height:a.el.height()})}if(a.autoSave){a._autoSave()}};this.chartComponent.afterRemoveIndicators=function(d){if(c.indicatorsPanel){c.indicatorsPanel.find("a[value='"+d.indicatorName+"']").removeClass("qs-urlchart-item-on")}if(a.chartComponent.indicatorsData[d.indicatorName].type==1){a._callResizeIFrame({height:a.el.height()})}if(a.autoSave){a._autoSave()}};this.chartComponent.afterAddValuationCallback=function(d){a._callResizeIFrame({height:a.el.height()});if(a.autoSave){a._autoSave()}};this.chartComponent.afterRemoveValuationCallback=function(d){if(c.fundamentalPanel){c.fundamentalPanel.find("a[value='"+d.name+"']").removeClass("qs-urlchart-item-on")}a._callResizeIFrame({height:a.el.height()});if(a.autoSave){a._autoSave()}};this.chartComponent.datePeriodChanged=function(d){if(d.zoomRange==11){a.statusConfig.zoomRange=11;if(c.zoom){c.zoom.find("a").removeClass("on")}}if(a.autoSave){a._autoSave()}};this.chartComponent.afterAddTickers=function(g){if(g&&g.symbol&&g.symbol.length){var e=g.symbol,f;for(var d=0;d<e.length;d++){f=a._getSymbolId(e[d]);if(c.relatedSec!=null){c.relatedSec.find("a[value='"+f+"']").addClass("qs-urlchart-item-on")}a._addSelectedItem(e[d].clientTicker,e[d].ticker,f)}}if(a.autoSave){a._autoSave()}};this.chartComponent.afterRemoveTickers=function(e){var d=a._getSymbolId(e.symbol);if(c.relatedSec!=null){c.relatedSec.find("a[value='"+d+"']").removeClass("qs-urlchart-item-on")}if(c.select!=null){c.select.find("a[value='"+d+"']").parent().remove()}if(a.autoSave){a._autoSave()}};this.chartComponent.afterSwitchIIV=function(d){if(c.iiv!=null&&a.uiComponents.iivChk){if(d.showIIVTicker){a.uiComponents.iivChk.btns.showIIV.select()}else{a.uiComponents.iivChk.btns.showIIV.inverse()}}};this.chartComponent.afterSwitchMainTickerFromCompareTickers=function(f,d){if(c.select!=null){var e=a._getSymbolId(f);c.select.find("a[value='"+d+"']").parent().remove();a._addSelectedItem(f.clientTicker,f.ticker,e)}}},_getChartProfile:function(){var b=$.extend(true,{},this.chartComponent.saveConfig());delete b.region;delete b.pWidth;delete b.pHeight;delete b.slider_StartDate;delete b.title;delete b.mHeight;delete b.lan;delete b.lock;delete b.cur;delete b.autoTitle;delete b.cur;delete b.isShowTimeSlider;for(var a in b.events){if(!b.events[a]){delete b.events[a]}}for(var a in b.tickerInfos){if(a==b.mTicker||a==b.mTicker+"IIV"){delete b.tickerInfos[a];continue}delete b.tickerInfos[a].Name;delete b.tickerInfos[a].ISIN;delete b.tickerInfos[a].companyId;delete b.tickerInfos[a].currency}b.height=this._elements.chart.height()+this.extHeight;return b},_getSymbolId:function(a){var b=(typeof(gData)!="undefined"&&a.gkey&&gData[a.gkey])?gData[a.gkey]:a;return b.type==8?b.secId:b.performanceId},_initUiComponentsStatus:function(){var a=this._elements,c=this.uiComponents;var d=this.statusConfig;if(d.chartCursor!=null&&a.chartCursor!=null){a.chartCursor.find("a[value='"+d.chartCursor+"']").addClass("qs-urlchart-item-on")}if(d.chartStyle!=null&&a.chartType!=null){a.chartType.find("a[value='"+d.chartStyle+"']").addClass("qs-urlchart-item-on")}if(c.yAxisRatio!=null){if(d.yaxisAlign!=null){c.yAxisRatio.btns[d.yaxisAlign].select()}else{c.yAxisRatio.btns.right.select()}}if(d.zRange!=null&&a.zoom!=null){a.zoom.find("a[value='"+d.zRange+"']").addClass("on")}if(c.scaleRatio!=null){if(d.scaleType!=null){c.scaleRatio.btns[d.scaleType].select()}else{c.scaleRatio.btns["0"].select()}}if(d.events!=null&&a.events!=null){for(var b in d.events){if(d.events[b]){a.events.find("a[value='"+b+"']").addClass("qs-urlchart-item-on")}}}if(d.indicatorsData!=null&&a.indicatorsPanel!=null){for(var b in d.indicatorsData){if(d.indicatorsData[b].show){a.indicatorsPanel.find("a[value='"+b+"']").addClass("qs-urlchart-item-on")}}}if(d.valuations!=null&&a.fundamentalPanel!=null){for(var b in d.valuations){if(d.valuations[b].show){a.fundamentalPanel.find("a[value='"+b+"']").addClass("qs-urlchart-item-on")}}}},_addIIVOption:function(){var b=this._elements.comparePanel?this._elements.comparePanel.find(".qs-urlchart-auto-lst"):null;var a=this;if(b!=null&&b.length&&this.chartComponent&&this.chartComponent.iivTicker!=null&&this.chartComponent.iivTicker!=""){if(!this._elements.iiv){this._elements.iiv=$('<div class="qs-urlchart-iiv-con"></div>').appendTo(b);this.uiComponents.iivChk=new Util.ButtonGroup(this._elements.iiv,[{txt:QS_Lang.Chart.inav+"/"+QS_Lang.Chart.nav,val:"showIIV"}],{onClick:function(c,d){if(c=="showIIV"){a.chartComponent.switchIIV(d.isSelected)}}},{type:"checkbox",vertical:true})}}},_addSelectedItem:function(g,a,h){var c=this._elements;if(c.select!=null){var f=g||a;if(c.relatedSec!=null){var b=c.relatedSec.find("a[value='"+h+"']");if(b.length){f=b.html()}}if(c.select.find("a[value='"+h+"']").length==0){var e='<li class="on"><a  href="javascript:void(0);">'+f+'</a><a class="close" href="javascript:void(0)" value='+h+">x</a></li>";c.select.append(e)}}},_callResizeIFrame:function(a){if(this.UIcfg.fixHeight){if(this.chartScrollPN){var b=this.fixedChartHeight;if(this.isTabConOpen&&this.panelHeight){b=b-this.panelHeight}this.chartScrollPN.reSize(null,b)}}else{if(typeof(this.onChartHeightChange)=="function"){this.onChartHeightChange(a)}}},_initAutoComplete:function(){var b=this;if(this.toolModules.compare&&this.toolModules.compare.items.autoBox){var d={showAdvance:false,needClear:true,urlCfg:{secType:this.type}};if(this.autoConfig.condition&&this.autoConfig.condition.length>0){d.urlCfg.condition=this.autoConfig.condition}if(this.autoConfig.category&&this.autoConfig.category.length>0){d.category=this.autoConfig.category}GB_qsAutoCompleteBox.subscription(this.chartId+"_autoBox",function(i,h){var g=i;b.chartComponent.addCompairTickers(g)},d);if(typeof(this.chartComponent.indexsMap)=="undefined"){if(this._elements.autoBox){this._elements.autoBox.find(".qs-benchmark").remove()}}else{var e=new simpleAutoCompleteBox(this.chartId+"_benchmarkBox",this.chartComponent.indexsMap,"key{txt}",{onclick:function(g){$(b.chartId+"_benchmarkBox").val("");b.chartComponent.addCompairTickers(g);var h=b.chartComponent.indexsMap[g]}},{width:180});e.init()}}if(this.autoConfig.showAuto){var c={showAdvance:false,needClear:true};if(this.autoConfig.showSecTypeOption){var f={"1":"STK","2":"OPT"};c.urlCfg={secType:this.type};if(this.autoConfig.condition&&this.autoConfig.condition.length>0){c.urlCfg.condition=this.autoConfig.condition}if(this.autoConfig.category&&this.autoConfig.category.length>0){c.category=this.autoConfig.category}c.searchDataCfg={Options:{ml:12}};var a=[{val:"1",txt:'<span class="auto-sectype-option">STK</span>Stock'},{val:"2",txt:'<span class="auto-sectype-option">OPT</span>Option'}];this.secTypeBtn=this.el.find(".auto-sectype-btn").data("secType",this.type);this.secTypeBtn[0].innerHTML=f[this.type];this.secTypeOption=new Util.CascadeMenu(this.el.find(".qs-urlchart-gbbox-con"),{autoHide:true},a,{onClick:function(g){b.secTypeBtn.data("secType",g.data.val);b.secTypeBtn[0].innerHTML=f[g.data.val];var h=GB_qsAutoCompleteBox.subscriptions[b.chartId+"gb_box"];h.setSecType(g.data.val)}});this.secTypeBtn.bind("click",function(h){var i=$(h.target);var g=i.offset();b.secTypeOption.setPosition(g.left-1,g.top+i.outerHeight(true));b.secTypeOption.show()})}GB_qsAutoCompleteBox.subscription(this.chartId+"gb_box",function(i,h){if(b.secTypeBtn!=null&&b.secTypeBtn.data("secType")==2&&b.autoConfig.showSecTypeOption){i=h.OS001||i}if(typeof(b.onTickerChange)=="function"&&h){b.onTickerChange({pid:h.type==8?h.secId:(h.performanceId?h.performanceId:i),exch:h.exch,ticker:h.ticker,clientTicker:h.clientTicker||h.OS001,component:"chart"})}var g=i;b.chartComponent.acceptTicker(g)},c);this.el.find(".qs-urlchart-gbbox-con .go").bind("click",function(g){var h=b.el.find("#"+b.chartId+"gb_box").val();if(h!=""){GB_qsAutoCompleteBox.triggerACB(b.chartId+"gb_box")}})}},_getRelatedSec:function(){var b=this;if(this.chartComponent.sType=="Options"){this._relatedArrived("")}else{var a=$.getJSON(this.relatedSecUrl+"&t="+this.statusConfig.mTicker+"&callback=?",function(c){b._relatedArrived(c)});if(a){a.fail(function(){b._relatedArrived("")})}}},_relatedArrived:function(e){var c="",b=this;for(var a=1;a<e.length;a++){c+='<a  class="qs-urlchart-item" idx="'+a+'" href="javascript:void(0);" value="'+e[a].PID+'">'+e[a].Symbol+"<span>"+e[a].Name+"</span></a>"}if(c==""){this._elements.relatedSec.html("").parent().hide()}else{this._elements.relatedSec.html(c).parent().show();var d=this.statusConfig;if(d.cTickers&&d.cTickers.length){for(var a=0;a<d.cTickers.length;a++){this._elements.relatedSec.find("a[value='"+d.cTickers[a]+"']").addClass("qs-urlchart-item-on")}}this._elements.relatedSec.find(".qs-urlchart-item").unbind("click").bind("click",function(f){var g=$(this);var h=g.attr("value");if(g.hasClass("qs-urlchart-item-on")){b.chartComponent.removeCompairTicker(h)}else{b.chartComponent.addCompairTickers(h)}})}},_showIndicatorParaPanel:function(d){var b=this._elements,f=this.chartComponent.indicatorUI;if(b.indicatorInputPanel!=null){b.indicatorInputPanel.find(".text H4").html(f[d].title);b.indicatorInputPanel.attr("value",d);var c="",e=f[d];for(var a=0;a<e.parameter.length;a++){c+='<div class="row"><div class="row-left"><span>'+e.parameter[a]+'</span></div><input type="text" class="qs-ui-ipt"  value="'+(typeof(e.defaultValue[a])=="undefined"?"":e.defaultValue[a])+'" ></div>'}b.indicatorInputPanel.find(".para-list").html(c);b.indicatorInputPanel.show()}},_changeRangeUI:function(a){this._elements.zoom.find("a").removeClass("on");this._elements.zoom.find("a[value="+a+"]").addClass("on")},acceptTicker:function(a){this.chartComponent.acceptTicker(a)},saveConfig:function(a){var b=this._getChartProfile();return $.toJSON(b)},_autoSave:function(){var a=this.saveConfig();if(typeof(this.onChartSaved)=="function"){this.onChartSaved(a)}},saveChartSetingToDB:function(a){if(GOLBAL_DATA&&GOLBAL_DATA.GlobalProfile&&typeof(QS_UserID)!="undefined"&&QS_UserID!=null){var c=this._getChartProfile();var b=$.toJSON(c);if(b!=$.toJSON(GOLBAL_DATA.GlobalProfile.webChartSetting)){GOLBAL_DATA.GlobalProfile.webChartSetting=c;var d={profile:$.toJSON(GOLBAL_DATA.GlobalProfile),action:"setprofile",tmpid:QS_UserID,uid:QS_UserID};$.post(this.globalProfileUrl,d,a)}}}};